INFO:InferenceInterface:Starting pipeline for userIds [0, 0, 0, 1, 1, 1]
INFO:InferenceInterface:Chosen topics: ['Familie', 'Yo mama joke', 'Sports', 'Mariage', 'Word play', 'Sex (dirty jokes)']
INFO:InferenceInterface:Calculating suggestions for userIds
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Familie
INFO:InferenceInterface:Starting pipeline for userIds [0, 0, 0, 1, 1, 1]
INFO:InferenceInterface:Chosen topics: ['Politics', 'Entertainment', 'Blondes joke', 'Money', 'Sports', 'Light bulb joke']
INFO:InferenceInterface:Calculating suggestions for userIds
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Politics
DEBUG:RecRAG:query sem search: Generate a joke with topic Politics
DEBUG:RecRAG:query cross encoder: Generate a joke for user 0
INFO:InferenceInterface:RAG returned following suggestions: [["What do you get when you cross a penis and a potato? A dictator ha....ha.......I'll be leaving now", 'What do you call it when the new US president waves his hand? A microwave.', "What is a politician's favorite kind of tea? Infideli-tea.", 'What’s the difference between a politician and a flying pig?\nThe letter F.', 'What do you get when you cross a penis with a potato? A Dictator.']] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Entertainment
DEBUG:RecRAG:query sem search: Generate a joke with topic Entertainment
DEBUG:RecRAG:query cross encoder: Generate a joke for user 0
INFO:InferenceInterface:RAG returned following suggestions: [["What do you get when you cross a penis and a potato? A dictator ha....ha.......I'll be leaving now", 'What do you call it when the new US president waves his hand? A microwave.', "What is a politician's favorite kind of tea? Infideli-tea.", 'What’s the difference between a politician and a flying pig?\nThe letter F.', 'What do you get when you cross a penis with a potato? A Dictator.'], ['What is the difference between a brothel and a circus? One is an array of cunning stunts!', 'Why did the chicken limp across the road? Because it was a lame joke.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'Two deer walk out of a gay bar\nOne turns and says to the other, "I can\'t believe I just blew thirty bucks in there."', "What is a goat's favourite form of comedy? Satyre."]] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Blondes joke
DEBUG:RecRAG:query sem search: Generate a joke with topic Blondes joke
DEBUG:RecRAG:query cross encoder: Generate a joke for user 0
INFO:InferenceInterface:RAG returned following suggestions: [["What do you get when you cross a penis and a potato? A dictator ha....ha.......I'll be leaving now", 'What do you call it when the new US president waves his hand? A microwave.', "What is a politician's favorite kind of tea? Infideli-tea.", 'What’s the difference between a politician and a flying pig?\nThe letter F.', 'What do you get when you cross a penis with a potato? A Dictator.'], ['What is the difference between a brothel and a circus? One is an array of cunning stunts!', 'Why did the chicken limp across the road? Because it was a lame joke.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'Two deer walk out of a gay bar\nOne turns and says to the other, "I can\'t believe I just blew thirty bucks in there."', "What is a goat's favourite form of comedy? Satyre."], ["Q: Why did the blonde give up bowling for  screwing? A: The balls are lighter and you don't have to change shoes.", 'How do you find out that a blonde girl got a bad day? She has a tampon behind her ear, and she is looking for her pencil.', 'Did you hear about the blonde who missed the 44  bus? She took the 22 twice instead.', "Q: Why couldn't the blonde add 10 and 7 on a calulator? A: She couldn't find the 10 key.", 'BLONDE BICYCLE Q: Why did the blonde run with the bike? A: It was going too fast for her to get on.']] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Money
DEBUG:RecRAG:query sem search: Generate a joke with topic Money
DEBUG:RecRAG:query cross encoder: Generate a joke for user 1
INFO:InferenceInterface:RAG returned following suggestions: [["What do you get when you cross a penis and a potato? A dictator ha....ha.......I'll be leaving now", 'What do you call it when the new US president waves his hand? A microwave.', "What is a politician's favorite kind of tea? Infideli-tea.", 'What’s the difference between a politician and a flying pig?\nThe letter F.', 'What do you get when you cross a penis with a potato? A Dictator.'], ['What is the difference between a brothel and a circus? One is an array of cunning stunts!', 'Why did the chicken limp across the road? Because it was a lame joke.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'Two deer walk out of a gay bar\nOne turns and says to the other, "I can\'t believe I just blew thirty bucks in there."', "What is a goat's favourite form of comedy? Satyre."], ["Q: Why did the blonde give up bowling for  screwing? A: The balls are lighter and you don't have to change shoes.", 'How do you find out that a blonde girl got a bad day? She has a tampon behind her ear, and she is looking for her pencil.', 'Did you hear about the blonde who missed the 44  bus? She took the 22 twice instead.', "Q: Why couldn't the blonde add 10 and 7 on a calulator? A: She couldn't find the 10 key.", 'BLONDE BICYCLE Q: Why did the blonde run with the bike? A: It was going too fast for her to get on.'], ['Why are diapers like $10 bills? Because you have to change them.', 'A man left his wife because he found out she was a prostitute and, boy, had he rung up a bill!', "What's the difference between a paycheck and a penis? You don't have to beg your girlfriend to blow your paycheck!", 'Why did the little girl eat her money for lunch? Because her mom gave her money for lunch. 8 year old sister told me this joke, gave me a good laugh.', 'What do you call a prostitute with her hands up her own skirt? Self Employed']] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Sports
DEBUG:RecRAG:query sem search: Generate a joke with topic Sports
DEBUG:RecRAG:query cross encoder: Generate a joke for user 1
INFO:InferenceInterface:RAG returned following suggestions: [["What do you get when you cross a penis and a potato? A dictator ha....ha.......I'll be leaving now", 'What do you call it when the new US president waves his hand? A microwave.', "What is a politician's favorite kind of tea? Infideli-tea.", 'What’s the difference between a politician and a flying pig?\nThe letter F.', 'What do you get when you cross a penis with a potato? A Dictator.'], ['What is the difference between a brothel and a circus? One is an array of cunning stunts!', 'Why did the chicken limp across the road? Because it was a lame joke.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'Two deer walk out of a gay bar\nOne turns and says to the other, "I can\'t believe I just blew thirty bucks in there."', "What is a goat's favourite form of comedy? Satyre."], ["Q: Why did the blonde give up bowling for  screwing? A: The balls are lighter and you don't have to change shoes.", 'How do you find out that a blonde girl got a bad day? She has a tampon behind her ear, and she is looking for her pencil.', 'Did you hear about the blonde who missed the 44  bus? She took the 22 twice instead.', "Q: Why couldn't the blonde add 10 and 7 on a calulator? A: She couldn't find the 10 key.", 'BLONDE BICYCLE Q: Why did the blonde run with the bike? A: It was going too fast for her to get on.'], ['Why are diapers like $10 bills? Because you have to change them.', 'A man left his wife because he found out she was a prostitute and, boy, had he rung up a bill!', "What's the difference between a paycheck and a penis? You don't have to beg your girlfriend to blow your paycheck!", 'Why did the little girl eat her money for lunch? Because her mom gave her money for lunch. 8 year old sister told me this joke, gave me a good laugh.', 'What do you call a prostitute with her hands up her own skirt? Self Employed'], ['Did you hear about the hockey game where all the players had leprosy? There was a face off in the corner.', "Q: Why did the blonde give up bowling for  screwing? A: The balls are lighter and you don't have to change shoes.", 'A man got a vasectomy without telling his wife. When she found out she said "ARE YOU SERIOUS?!" "Yes, I\'m not kidding you." he said.', 'Why do Kenyans always win marathons? At the end, they get a bag of chips and a Coke. -My dad told me this joke when we went to a race-', 'BLONDE BICYCLE Q: Why did the blonde run with the bike? A: It was going too fast for her to get on.']] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Light bulb joke
DEBUG:RecRAG:query sem search: Generate a joke with topic Light bulb joke
DEBUG:RecRAG:query cross encoder: Generate a joke for user 1
INFO:InferenceInterface:RAG returned following suggestions: [["What do you get when you cross a penis and a potato? A dictator ha....ha.......I'll be leaving now", 'What do you call it when the new US president waves his hand? A microwave.', "What is a politician's favorite kind of tea? Infideli-tea.", 'What’s the difference between a politician and a flying pig?\nThe letter F.', 'What do you get when you cross a penis with a potato? A Dictator.'], ['What is the difference between a brothel and a circus? One is an array of cunning stunts!', 'Why did the chicken limp across the road? Because it was a lame joke.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'Two deer walk out of a gay bar\nOne turns and says to the other, "I can\'t believe I just blew thirty bucks in there."', "What is a goat's favourite form of comedy? Satyre."], ["Q: Why did the blonde give up bowling for  screwing? A: The balls are lighter and you don't have to change shoes.", 'How do you find out that a blonde girl got a bad day? She has a tampon behind her ear, and she is looking for her pencil.', 'Did you hear about the blonde who missed the 44  bus? She took the 22 twice instead.', "Q: Why couldn't the blonde add 10 and 7 on a calulator? A: She couldn't find the 10 key.", 'BLONDE BICYCLE Q: Why did the blonde run with the bike? A: It was going too fast for her to get on.'], ['Why are diapers like $10 bills? Because you have to change them.', 'A man left his wife because he found out she was a prostitute and, boy, had he rung up a bill!', "What's the difference between a paycheck and a penis? You don't have to beg your girlfriend to blow your paycheck!", 'Why did the little girl eat her money for lunch? Because her mom gave her money for lunch. 8 year old sister told me this joke, gave me a good laugh.', 'What do you call a prostitute with her hands up her own skirt? Self Employed'], ['Did you hear about the hockey game where all the players had leprosy? There was a face off in the corner.', "Q: Why did the blonde give up bowling for  screwing? A: The balls are lighter and you don't have to change shoes.", 'A man got a vasectomy without telling his wife. When she found out she said "ARE YOU SERIOUS?!" "Yes, I\'m not kidding you." he said.', 'Why do Kenyans always win marathons? At the end, they get a bag of chips and a Coke. -My dad told me this joke when we went to a race-', 'BLONDE BICYCLE Q: Why did the blonde run with the bike? A: It was going too fast for her to get on.'], ['My girlfriend said if I turned off the light, I could stick it in her ass.\nAfter I tried, she freaked out and told me never again.\n\nI guess the bulb was hot.', "How many ladybugs does it take to screw in a light bulb? Two, but don't ask me how they got in there.", '[NSFW] Had sex with my girlfriend a couple days ago..\nMy girlfriend and I had sex a couple of days ago.\n\nShe looked at me and said, "Turn the light off and stick it in my butt".\n\nI guess I should have waited for the bulb to cool off first.', 'Yesterday, I changed a light bulb, crossed the street, and walked into a bar.\nMy life is a joke.', 'Q: How many Hillary Clintons does it take to change a light bulb? A: One--she just holds the bulb and the world revolves around her.']] 
INFO:InferenceInterface:Generating outputs
INFO:InferenceInterface:Extracting jokes
WARNING:InferenceInterface:Failed to extract 9 jokes
INFO:InferenceInterface:BoN filtering
INFO:BoN:DF for BoN:    userId                                           jokeText     score
0       0  \nWhat do you get when you cross a politician ...  2.734801
1       0                                                     1.304751
2       0                                                     1.304751
3       0                                                     1.304751
4       0  \nWhat do you get when you cross a politician ...  2.828348
INFO:BoN:UserId: 0
INFO:BoN:Amount of jokes: 3
INFO:BoN:ranked jokes: Index([11, 13, 12, 10, 5, 4, 0, 2, 6, 7, 8, 9, 3, 1, 14], dtype='int64')
INFO:BoN:best jokes: ['\nQ: Why did the blonde give up knitting for screwing?\nA: The needles are softer and you don’t have to count stitches.\n', "\nQ: Why did the blonde switch from bowling to golf?\nA: The clubs are lighter and she doesn't have to wear socks.\n", '\nQ: Why did the blonde switch from bowling to archery?\nA: The arrows are lighter and you don’t need to change gloves.\n']
INFO:BoN:UserId: 1
INFO:BoN:Amount of jokes: 3
INFO:BoN:ranked jokes: Index([20, 17, 16, 27, 26, 24, 29, 28, 25, 23, 15, 19, 22, 18, 21], dtype='int64')
INFO:BoN:best jokes: ['\nQ: Why did the blonde give up knitting for screwing?\nA: The needles are softer and you don’t have to count stitches.\n', "\nQ: Why did the blonde switch from bowling to golf?\nA: The clubs are lighter and she doesn't have to wear socks.\n", '\nQ: Why did the blonde switch from bowling to archery?\nA: The arrows are lighter and you don’t need to change gloves.\n', '\nQ: Why did the blonde run with the car?  \nA: It was going too fast for her to get in.\n', "\n   Why are remote controls like umbrellas? Because you can't find them when you need them.\n   ", '\n   What do you call a barber who cuts his own hair? Self-haircut.\n   ']
INFO:InferenceInterface:Starting pipeline for userIds [2, 2, 2]
INFO:InferenceInterface:Chosen topics: ['Docter-patient', 'Mariage', 'Word play']
INFO:InferenceInterface:Calculating suggestions for userIds
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Docter-patient
DEBUG:RecRAG:query sem search: Generate a joke with topic Docter-patient
DEBUG:RecRAG:query cross encoder: Generate a joke for user 2
INFO:InferenceInterface:RAG returned following suggestions: [['Q: What did the blonde say when her doctor told her that she was pregnant? A: "Is it mine?"', 'What did the doctor say to the rude patient who was reluctant to get stitches from him? "Fine, suture yourself."', 'Patient: I don’t know what’s wrong with me, Doc. My nose runs and my feet smell.\nDoctor: You’re upside down!', 'What do you call a deaf Gynocologist? A lip reader.', 'A man walks into a psychologists office... wearing nothing but saran wrap. The psychologist says "It\'s a good thing you came. I can clearly see your nuts"']] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Mariage
DEBUG:RecRAG:query sem search: Generate a joke with topic Mariage
DEBUG:RecRAG:query cross encoder: Generate a joke for user 2
INFO:InferenceInterface:RAG returned following suggestions: [['Q: What did the blonde say when her doctor told her that she was pregnant? A: "Is it mine?"', 'What did the doctor say to the rude patient who was reluctant to get stitches from him? "Fine, suture yourself."', 'Patient: I don’t know what’s wrong with me, Doc. My nose runs and my feet smell.\nDoctor: You’re upside down!', 'What do you call a deaf Gynocologist? A lip reader.', 'A man walks into a psychologists office... wearing nothing but saran wrap. The psychologist says "It\'s a good thing you came. I can clearly see your nuts"'], ['Joseph and Mary are having a romp in the hay. Mary says, "what if I get pregnant, what will I tell them?" Joseph replies, "you will think of something."', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', "What is a goat's favourite form of comedy? Satyre.", 'Where do little jokes come from?\nWell, a dad joke meets yo momma joke and then they knock knock.\n\n(I made this up myself, I’m really proud of it)', 'What do you call a masterbating cow? Beef stroganoff']] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Word play
DEBUG:RecRAG:query sem search: Generate a joke with topic Word play
DEBUG:RecRAG:query cross encoder: Generate a joke for user 2
INFO:InferenceInterface:RAG returned following suggestions: [['Q: What did the blonde say when her doctor told her that she was pregnant? A: "Is it mine?"', 'What did the doctor say to the rude patient who was reluctant to get stitches from him? "Fine, suture yourself."', 'Patient: I don’t know what’s wrong with me, Doc. My nose runs and my feet smell.\nDoctor: You’re upside down!', 'What do you call a deaf Gynocologist? A lip reader.', 'A man walks into a psychologists office... wearing nothing but saran wrap. The psychologist says "It\'s a good thing you came. I can clearly see your nuts"'], ['Joseph and Mary are having a romp in the hay. Mary says, "what if I get pregnant, what will I tell them?" Joseph replies, "you will think of something."', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', "What is a goat's favourite form of comedy? Satyre.", 'Where do little jokes come from?\nWell, a dad joke meets yo momma joke and then they knock knock.\n\n(I made this up myself, I’m really proud of it)', 'What do you call a masterbating cow? Beef stroganoff'], ['Jokes so bad.... [..they will make you ho(a)rse](http://www.arkinspace.com/2011/07/jokes-so-bad-they-will-make-you-hoarse.html)', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', "What is a goat's favourite form of comedy? Satyre.", "Q: What thoughts do Blondes have after reading these jokes? A: None as usual... and they most likely didn't understand them either.", 'Where do little jokes come from?\nWell, a dad joke meets yo momma joke and then they knock knock.\n\n(I made this up myself, I’m really proud of it)']] 
INFO:InferenceInterface:Generating outputs
INFO:InferenceInterface:Extracting jokes
WARNING:InferenceInterface:Failed to extract 5 jokes
INFO:InferenceInterface:BoN filtering
INFO:BoN:DF for BoN:    userId jokeText     score
0       2           1.339638
1       2           1.339638
2       2           1.339638
3       2           1.339638
4       2           1.339638
INFO:BoN:UserId: 2
INFO:BoN:Amount of jokes: 3
INFO:BoN:ranked jokes: Index([5, 14, 11, 13, 12, 10, 7, 9, 6, 8, 3, 0, 4, 1, 2], dtype='int64')
INFO:BoN:best jokes: ['\nJoseph and Mary are having a romp in the hay. Mary says, "What if we get caught? You\'ll think of something."\n', '\nJokes so bad... they’ll make you ho(a)rse and wonder if you should just neigh.\n', "Jokes so bad... they'll make you ho(a)rse-laughing until you're hoarse and horsed-out."]
DEBUG:urllib3.connectionpool:Resetting dropped connection: huggingface.co
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/repos/create HTTP/1.1" 409 125
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/datasets/SeppeV/gen_joke_optimisation_test_2/preupload/main HTTP/1.1" 200 224
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /datasets/SeppeV/gen_joke_optimisation_test_2.git/info/lfs/objects/batch HTTP/1.1" 200 920
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-hub-lfs-us-east-1.s3-accelerate.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://hf-hub-lfs-us-east-1.s3-accelerate.amazonaws.com:443 "PUT /repos/92/9a/929a89d7528ca4112d6eee36e00855ea523032399918127355d142d904120f7b/dbe91fefce9672bb6f169d47de43d8df0dde2057512338f216bb00af0505eb7c?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIA2JU7TKAQLC2QXPN7%2F20250330%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250330T134221Z&X-Amz-Expires=900&X-Amz-Signature=c752fbb20fe8c7e3a2d4abdd587d9d61f4a548f70b6eb4094b82192ec5d04c3a&X-Amz-SignedHeaders=host&x-amz-storage-class=INTELLIGENT_TIERING&x-id=PutObject HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /datasets/SeppeV/gen_joke_optimisation_test_2.git/info/lfs/objects/verify HTTP/1.1" 200 2
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/datasets/SeppeV/gen_joke_optimisation_test_2/tree/main?recursive=True&expand=False HTTP/1.1" 200 521
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /datasets/SeppeV/gen_joke_optimisation_test_2/resolve/main/README.md HTTP/1.1" 200 0
DEBUG:filelock:Attempting to acquire lock 22391176731120 on /scratch/leuven/368/vsc36814/huggingface_cache/hub/.locks/datasets--SeppeV--gen_joke_optimisation_test_2/29c46d88a0c27039da5cb2d6ff21701c9a3cae24.lock
DEBUG:filelock:Lock 22391176731120 acquired on /scratch/leuven/368/vsc36814/huggingface_cache/hub/.locks/datasets--SeppeV--gen_joke_optimisation_test_2/29c46d88a0c27039da5cb2d6ff21701c9a3cae24.lock
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /datasets/SeppeV/gen_joke_optimisation_test_2/resolve/main/README.md HTTP/1.1" 200 335
DEBUG:filelock:Attempting to release lock 22391176731120 on /scratch/leuven/368/vsc36814/huggingface_cache/hub/.locks/datasets--SeppeV--gen_joke_optimisation_test_2/29c46d88a0c27039da5cb2d6ff21701c9a3cae24.lock
DEBUG:filelock:Lock 22391176731120 released on /scratch/leuven/368/vsc36814/huggingface_cache/hub/.locks/datasets--SeppeV--gen_joke_optimisation_test_2/29c46d88a0c27039da5cb2d6ff21701c9a3cae24.lock
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/validate-yaml HTTP/1.1" 200 27
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/datasets/SeppeV/gen_joke_optimisation_test_2/preupload/main HTTP/1.1" 200 180
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/datasets/SeppeV/gen_joke_optimisation_test_2/commit/main HTTP/1.1" 200 217
INFO:InferenceInterface:Starting pipeline for userIds [0, 0, 0, 0, 1, 1, 1, 1]
INFO:InferenceInterface:Chosen topics: ['Word play', 'Word play', 'Politics', 'Technology', 'Work situations', 'Knock-knock joke', 'Entertainment', 'Sports']
INFO:InferenceInterface:Calculating suggestions for userIds
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Word play
DEBUG:RecRAG:query sem search: Generate a joke with topic Word play
DEBUG:RecRAG:query cross encoder: Generate a joke for user 0
INFO:InferenceInterface:RAG returned following suggestions: ['Why did the chicken limp across the road? Because it was a lame joke.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', "What is a goat's favourite form of comedy? Satyre.", 'Where do little jokes come from?\nWell, a dad joke meets yo momma joke and then they knock knock.\n\n(I made this up myself, I’m really proud of it)', "Want to hear a joke about my penis? Ahh forget it.. it it's too long. Woman replies: want to hear a joke about my vagina? Ahh never mind... you'll never get it."] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Word play
DEBUG:RecRAG:query sem search: Generate a joke with topic Word play
DEBUG:RecRAG:query cross encoder: Generate a joke for user 0
INFO:InferenceInterface:RAG returned following suggestions: ['Why did the chicken limp across the road? Because it was a lame joke.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', "What is a goat's favourite form of comedy? Satyre.", 'Where do little jokes come from?\nWell, a dad joke meets yo momma joke and then they knock knock.\n\n(I made this up myself, I’m really proud of it)', "Want to hear a joke about my penis? Ahh forget it.. it it's too long. Woman replies: want to hear a joke about my vagina? Ahh never mind... you'll never get it."] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Politics
DEBUG:RecRAG:query sem search: Generate a joke with topic Politics
DEBUG:RecRAG:query cross encoder: Generate a joke for user 0
INFO:InferenceInterface:RAG returned following suggestions: ["What do you get when you cross a penis and a potato? A dictator ha....ha.......I'll be leaving now", 'What do you call it when the new US president waves his hand? A microwave.', "What is a politician's favorite kind of tea? Infideli-tea.", 'What’s the difference between a politician and a flying pig?\nThe letter F.', 'What do you get when you cross a penis with a potato? A Dictator.'] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Technology
DEBUG:RecRAG:query sem search: Generate a joke with topic Technology
DEBUG:RecRAG:query cross encoder: Generate a joke for user 0
INFO:InferenceInterface:RAG returned following suggestions: ['A man got a vasectomy without telling his wife. When she found out she said "ARE YOU SERIOUS?!" "Yes, I\'m not kidding you." he said.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'What do you call it when the new US president waves his hand? A microwave.', 'What do you say when the inventor of the telephone falls over? Alexander Graham Fell!', '2 apples are sitting in an oven One apple looks to the other and says "Man is it hot in here or what?" The second apple screams "Holy shit!?! A talking apple!"'] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Work situations
DEBUG:RecRAG:query sem search: Generate a joke with topic Work situations
DEBUG:RecRAG:query cross encoder: Generate a joke for user 1
INFO:InferenceInterface:RAG returned following suggestions: ['I wanted the day off work today so I phoned my boss to tell him I was sick... He said "You don\'t sound sick." I said "I\'m fucking my sister, is that sick enough for you?" Well... I got the day off.', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'Husband asked his wife "why don\'t you tell me when you orgasm?"\nShe replied "because I don\'t like calling you at work."', 'A blonde goes to work in tears.\nA blonde goes to work in tears. Her boss asks, "What\'s wrong?" \nShe says, "My mom died." He told her to go home, but she said, "No, I\'ll be fine." Later that day, her boss finds her crying again. He says, "What\'s wrong?" She replies, "I just talked to my sister, and her mom died, too!"', 'What do you call a prostitute with her hands up her own skirt? Self Employed'] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Knock-knock joke
DEBUG:RecRAG:query sem search: Generate a joke with topic Knock-knock joke
DEBUG:RecRAG:query cross encoder: Generate a joke for user 1
INFO:InferenceInterface:RAG returned following suggestions: ['Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'My 7 y/o niece just dad joked me.\n**Her:** "Do you know any jokes?"\n\n**Me:** "No."\n\n**Her:** "I\'ll teach you one."\n        \n      \n   "Knock! Knock!"\n\n**Me:** "Who\'s there?"\n\n**Her:** "Ash."\n        \n      \n  "Now ask, Ash: who?"\n\n**Me:** "Ash: who?"\n\n**Her:** "Please cover your mouth when you sneeze."\n\n**Me: rekt**', 'Q: What did the blonde say when her doctor told her that she was pregnant? A: "Is it mine?"', 'Guy runs into a bar, yells "Quick! How tall is a penguin?"\nBartender says "Three feet tall."\n\nGuy says "Oh my God! I just ran over a nun!"', 'A sandwich walks into a bar. The bartender says, "Get out. We don\'t serve food in here!"'] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Entertainment
DEBUG:RecRAG:query sem search: Generate a joke with topic Entertainment
DEBUG:RecRAG:query cross encoder: Generate a joke for user 1
INFO:InferenceInterface:RAG returned following suggestions: ['Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'My 7 y/o niece just dad joked me.\n**Her:** "Do you know any jokes?"\n\n**Me:** "No."\n\n**Her:** "I\'ll teach you one."\n        \n      \n   "Knock! Knock!"\n\n**Me:** "Who\'s there?"\n\n**Her:** "Ash."\n        \n      \n  "Now ask, Ash: who?"\n\n**Me:** "Ash: who?"\n\n**Her:** "Please cover your mouth when you sneeze."\n\n**Me: rekt**', 'A sandwich walks into a bar And orders a drink. The bartender says : "sorry sir, we don\'t serve food".', "What does a good joke and a man who's dropped his last Viagra down the drain have in common? A missed erection.", 'A sandwich walks into a bar. The bartender says, "Get out. We don\'t serve food in here!"'] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Sports
DEBUG:RecRAG:query sem search: Generate a joke with topic Sports
DEBUG:RecRAG:query cross encoder: Generate a joke for user 1
INFO:InferenceInterface:RAG returned following suggestions: ['Did you hear about the hockey game where all the players had leprosy? There was a face off in the corner.', "Q: Why did the blonde give up bowling for  screwing? A: The balls are lighter and you don't have to change shoes.", 'A man got a vasectomy without telling his wife. When she found out she said "ARE YOU SERIOUS?!" "Yes, I\'m not kidding you." he said.', 'Why do Kenyans always win marathons? At the end, they get a bag of chips and a Coke. -My dad told me this joke when we went to a race-', 'BLONDE BICYCLE Q: Why did the blonde run with the bike? A: It was going too fast for her to get on.'] 
INFO:InferenceInterface:Generating outputs
INFO:InferenceInterface:Extracting jokes
WARNING:InferenceInterface:Failed to extract 24 jokes
INFO:InferenceInterface:BoN filtering
INFO:BoN:DF for BoN:    userId                                           jokeText     score
0       0  \nWhy did the pig limp across the mud? Because...  2.813003
1       0                                                     1.304751
2       0  \nWhy did the chicken limp across the road? Be...  2.638655
3       0  \nWhy did the turkey waddle across the road? B...  2.874744
4       0  \nWhy did the turkey cross the road? Because i...  2.975736
INFO:BoN:UserId: 0
INFO:BoN:Amount of jokes: 4
INFO:BoN:ranked jokes: Index([4, 6, 5, 3, 0, 9, 2, 7, 1, 13, 14, 15, 8, 10, 11, 16, 17, 18, 19, 12], dtype='int64')
INFO:BoN:best jokes: ['\nWhy did the turkey cross the road? Because it was a gobble-dee-doo joke.\n', '\nWhy did the chicken waddle across the road? Because it was a duck joke.\n', '\nWhy did the duck waddle across the road? Because it was a quack joke.\n', '\nWhy did the turkey waddle across the road? Because it was a fowl joke.\n']
INFO:BoN:UserId: 1
INFO:BoN:Amount of jokes: 4
INFO:BoN:ranked jokes: Index([36, 39, 23, 20, 21, 22, 24, 28, 34, 27, 26, 25, 31, 30, 29, 32, 35, 33,
       37, 38],
      dtype='int64')
INFO:BoN:best jokes: ['\nWhy did the turkey cross the road? Because it was a gobble-dee-doo joke.\n', '\nWhy did the chicken waddle across the road? Because it was a duck joke.\n', '\nWhy did the duck waddle across the road? Because it was a quack joke.\n', '\nWhy did the turkey waddle across the road? Because it was a fowl joke.\n', '\n\n### Step-by-step analysis:\n\n#### Analyzing the Inspirational Jokes:\n1. **Hockey Game with Leprosy**: This joke uses a play on words and situational humor. The setup is a hockey game where all players have leprosy, which leads to a punchline that combines the game\'s terminology ("face-off") with the disease\'s symptoms (loss of sensation). The key elements are the unexpected combination of the sport and the disease, and the play on words.\n\n2. **Blonde Bowling vs. Screwing**: This is a pun-based joke, playing on the double meaning of "balls" and "changing shoes". It relies on stereotypes and wordplay. Key elements include the puns and the stereotype of blondes.\n\n3. **Vasectomy Joke**: This joke is a play on words with a twist ending. The punchline is a pun on "serious" and "not kidding", making it a clever wordplay joke. The key elements are the surprise and the wordplay.\n\n4. **Kenyans Winning Marathons**: This joke uses cultural stereotypes and a play on words. The punchline is a humorous exaggeration of rewards given after a marathon, making it observational humor. Key elements are the cultural stereotype and the play on words.\n\n5. **Blonde Bicycle**: This joke uses a stereotype and a play on words. The punchline is a pun on "going too fast" and the inability to get on the bike. Key elements are the stereotype and the pun.\n\n#### Chosen Joke Analysis:\n**Hockey Game with Leprosy**: The joke uses a play on words and situational humor. It combines a sport with a disease in an unexpected way, leading to a punchline that plays on the terminology of the sport.\n\n#### Potential Punchlines:\n1. Why did the hockey player decide to become a baker? Because he wanted to prove that he could knead the dough without a face-off in the corner.\n2. Why did the hockey player become a chef? He wanted to show he could handle hot plates without a face-off in the kitchen.\n3. Why did the hockey player switch to golf? He wanted to avoid a face-off in the bunker.\n4. Why did the hockey player become a baker? To show he could mix dough without a face-off in the oven.\n5. Why did the hockey player become a baker? To prove he could knead bread without a face-off in the flour.\n\n#### Ranking the Punchlines:\n- **Funniness**: Punchline 1 > Punchline 3 > Punchline 4 > Punchline 2 > Punchline 5\n- **Fit with Inspirational Jokes**: Punchline 1 > Punchline 3 > Punchline 4 > Punchline 2 > Punchline 5\n- **Newness**: Punchline 1 > Punchline 3 > Punchline 4 > Punchline 2 > Punchline 5\n\n#### Best Punchline:\nThe best punchline is Punchline 1 because it maintains the structure and idea of the original joke while adding a fresh twist. It combines the sport of hockey with baking, using a similar play on words and situational humor.\n\n### Final Joke:\n<joke>Why did the hockey player decide to become a baker? Because he wanted to prove that he could knead the dough without a face-off in the corner.', '\n   Why did the hockey player break up with his girlfriend? She kept saying "face-off" whenever he tried to kiss her.\n   ', '\nI wanted the day off work today so I phoned my boss to tell him I was sick... He said "You don\'t sound sick." I said "I\'m eating live octopuses, is that sick enough for you?" Well... I got the day off.\n', '\nI wanted the day off work today so I phoned my boss to tell him I was sick... He said "You don\'t sound sick." I said "I\'m fucking my sister, is that sick enough for you?" He said, "You\'re right, that\'s pretty sick. Go home." Well... I got the day off.\n']
INFO:InferenceInterface:Starting pipeline for userIds [2, 2, 2, 2]
INFO:InferenceInterface:Chosen topics: ['Nature', 'Technology', 'Money', 'Work situations']
INFO:InferenceInterface:Calculating suggestions for userIds
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Nature
DEBUG:RecRAG:query sem search: Generate a joke with topic Nature
DEBUG:RecRAG:query cross encoder: Generate a joke for user 2
INFO:InferenceInterface:RAG returned following suggestions: ['What does your mom and a rain forest have in common? If you look deep enough in the bush, you might find a cockatoo.', "What is a goat's favourite form of comedy? Satyre.", "What's the difference between a seal and a sea lion?\nOne electron.", "Why can't you hear a pterodactyl urinate?\nBecause they have been extinct for millions of years.", 'JOEY: You want to hear a joke about trees?\nBEN: Sure!\nJOEY: Nah, it’s too sappy.'] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Technology
DEBUG:RecRAG:query sem search: Generate a joke with topic Technology
DEBUG:RecRAG:query cross encoder: Generate a joke for user 2
INFO:InferenceInterface:RAG returned following suggestions: ['An electrical engineer is talking to a blonde the blonde asks: "What do you do for a living?" The engineer replies " I make chips" "Oh yummy!"', 'What do you say when the inventor of the telephone falls over? Alexander Graham Fell!', 'Teacher: Why are you late? Student: Because of the sign on the road. Teacher: What type of sign? Student: The sign that says, "School Ahead, Go Slow."!', 'Q: What did the rude prism say to the light beam that smacked into him? A: Get bent!', 'What do you call a blonde who dyes her hair brunette? Artificial intelligence *edit: I kinda thought it was funny, and* poof *it has 3000 upvotes. Thanks for the motivation*'] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Money
DEBUG:RecRAG:query sem search: Generate a joke with topic Money
DEBUG:RecRAG:query cross encoder: Generate a joke for user 2
INFO:InferenceInterface:RAG returned following suggestions: ['What noise does a nut make when it has a cold? ... CASHEWW!', 'Why are diapers like $10 bills? Because you have to change them.', 'Two deer walk out of a gay bar\nOne turns and says to the other, "I can\'t believe I just blew thirty bucks in there."', 'The trump family is flying from New York to DC\nDonald looks down on the cities below and says "I think I\'ll throw a 1000$ bill out of the window and make some american happy. Melanie says "Oh honey why not throw 10 100$ bills and make 10 americans happy?" \nSo then Ivanka says "Even better daddy, throw 100 ten dollar bills out of the window and make 100 americans happy?" To that the pilot says " Why dont you all jump out the window and make the whole country happy?"', 'What do you call a rich frog ? A golf blooded reptile !'] 
INFO:InferenceInterface:Getting suggestions for: Generate a joke with topic Work situations
DEBUG:RecRAG:query sem search: Generate a joke with topic Work situations
DEBUG:RecRAG:query cross encoder: Generate a joke for user 2
INFO:InferenceInterface:RAG returned following suggestions: ['Joseph and Mary are having a romp in the hay. Mary says, "what if I get pregnant, what will I tell them?" Joseph replies, "you will think of something."', 'An electrical engineer is talking to a blonde the blonde asks: "What do you do for a living?" The engineer replies " I make chips" "Oh yummy!"', 'Why did the dyslexic man have slime on his face? Because I told him a good joke.', 'Teacher: Why are you late? Student: Because of the sign on the road. Teacher: What type of sign? Student: The sign that says, "School Ahead, Go Slow."!', "Q: What thoughts do Blondes have after reading these jokes? A: None as usual... and they most likely didn't understand them either."] 
INFO:InferenceInterface:Generating outputs
INFO:InferenceInterface:Extracting jokes
WARNING:InferenceInterface:Failed to extract 10 jokes
INFO:InferenceInterface:BoN filtering
INFO:BoN:DF for BoN:    userId jokeText     score
0       2           1.339638
1       2           1.339638
2       2           1.339638
3       2           1.339638
4       2           1.339638
INFO:BoN:UserId: 2
INFO:BoN:Amount of jokes: 4
INFO:BoN:ranked jokes: Index([19, 16, 18, 17, 12, 13, 10, 15, 11, 14, 1, 0, 3, 2, 8, 9, 5, 4, 6, 7], dtype='int64')
INFO:BoN:best jokes: ['\nQ: What do you do for a living?\nA: I make babies.\nPunchline: Oh, yummy!\n', '\nAn astronaut asked their partner, "What if we get lost in space?" Their partner replied, "We\'ll think of something."\n', '\nMary and Joseph are having a romp in the hay. Mary says, "What if I get pregnant, what will I tell them?" Joseph replies, "Just say you were optimizing the gene pool."\n', '\nMary and Joseph are having a moment under the stars. Mary looks up and says, "What if I get pregnant? What will we tell everyone?" Joseph smiles and replies, "We\'ll say the baby was conceived under the most starry of skies."\n']
DEBUG:urllib3.connectionpool:Resetting dropped connection: huggingface.co
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/repos/create HTTP/1.1" 200 134
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/datasets/SeppeV/FullGen_for_survey/preupload/main HTTP/1.1" 200 151
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /datasets/SeppeV/FullGen_for_survey.git/info/lfs/objects/batch HTTP/1.1" 200 910
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): hf-hub-lfs-us-east-1.s3-accelerate.amazonaws.com:443
DEBUG:urllib3.connectionpool:https://hf-hub-lfs-us-east-1.s3-accelerate.amazonaws.com:443 "PUT /repos/e2/05/e205dbd47b4fce355dafe1fe089d5ea31016ec739ac2944aaaf15dceb14e4803/50232b842d1882e3f70f2f711e6ad4a8e07b18be641c8c44e87ffc529b0936b4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIA2JU7TKAQLC2QXPN7%2F20250330%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250330T162541Z&X-Amz-Expires=900&X-Amz-Signature=e0ad38d2e55c2c2db10d62ac6177a9615f78375a9bc5a22ac0f7db2522072606&X-Amz-SignedHeaders=host&x-amz-storage-class=INTELLIGENT_TIERING&x-id=PutObject HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /datasets/SeppeV/FullGen_for_survey.git/info/lfs/objects/verify HTTP/1.1" 200 2
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "GET /api/datasets/SeppeV/FullGen_for_survey/tree/main?recursive=True&expand=False HTTP/1.1" 200 102
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/validate-yaml HTTP/1.1" 200 27
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/datasets/SeppeV/FullGen_for_survey/preupload/main HTTP/1.1" 200 131
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "POST /api/datasets/SeppeV/FullGen_for_survey/commit/main HTTP/1.1" 200 207
WARNING:InferenceInterface:Failed to extract 6 jokes
WARNING:InferenceInterface:Failed to extract 3 jokes
WARNING:InferenceInterface:Failed to extract 3 jokes
WARNING:InferenceInterface:Failed to extract 2 jokes
WARNING:InferenceInterface:Failed to extract 1 jokes
WARNING:InferenceInterface:Failed to extract 2 jokes
WARNING:InferenceInterface:Failed to extract 8 jokes
WARNING:InferenceInterface:Failed to extract 7 jokes
